<div class="settings-page">
  <div class="content">
    <!-- Navbar built-in (removed since we have global navbar) -->

    <!-- Header -->
    <div class="page-header">
      <h1 class="page-title"><i class="fas fa-envelope"></i> Contact Us</h1>
      <p class="page-subtitle">Get in touch with our team or request a call back.</p>
    </div>

    <div class="card-grid">
      <section class="card wide">
        <h2><i class="fas fa-store"></i> Brand Details</h2>
        <p class="muted">Key information about the brand for quick reference.</p>
        <div class="details-grid">
          <div class="detail-row">
            <span><i class="fas fa-envelope"></i> Support Email</span>
            <span class="highlight">support@localcraft.com</span>
          </div>
          <div class="detail-row">
            <span><i class="fas fa-phone"></i> Hotline</span>
            <span class="highlight">+20 10 0000 0000</span>
          </div>
          <div class="detail-row">
            <span><i class="fas fa-clock"></i> Working Hours</span>
            <span class="highlight">Sat-Thu, 9:00 AM - 6:00 PM</span>
          </div>
          <div class="detail-row">
            <span><i class="fas fa-map-marker-alt"></i> Address</span>
            <span class="highlight">Local Craft HQ, Cairo, Egypt</span>
          </div>
        </div>
      </section>

      <section class="card">
        <h2><i class="fas fa-link"></i> Social Links</h2>
        <p class="muted">Follow the brand on social media.</p>
        <div class="social-links">
          @for (link of socialLinks; track link.name) {
          <a class="social-link" [href]="link.url" target="_blank">
            <i [class]="link.icon"></i>
            <span>{{ link.name }}</span>
          </a>
          }
        </div>
      </section>

      <section class="card">
        <h2><i class="fas fa-phone"></i> Contact Management</h2>
        <p class="muted">Send your phone and issue reason. Admin will approve and contact you.</p>

        <div class="status-summary" *ngIf="isLoggedIn && requests.length">
          <span class="chip success"
            ><i class="fas fa-check-circle"></i> {{ approvedCount }} approved</span
          >
          <span class="chip warn"><i class="fas fa-clock"></i> {{ pendingCount }} pending</span>
          <span class="chip danger"
            ><i class="fas fa-times-circle"></i> {{ rejectedCount }} rejected</span
          >
        </div>

        <div class="status-summary" *ngIf="isLoggedIn && isLoadingRequests">
          <span class="chip neutral"
            ><i class="fas fa-spinner fa-spin"></i> Loading your requests...</span
          >
        </div>

        <div class="alert error" *ngIf="isLoggedIn && requestsError">
          <i class="fas fa-exclamation-circle"></i>
          <span>{{ requestsError }}</span>
        </div>

        <div *ngIf="!isLoggedIn" class="alert">
          Please <a routerLink="/login">login</a> to send a request.
        </div>

        <div *ngIf="isLoggedIn">
          <label class="field">
            <span>Phone</span>
            <input type="text" [(ngModel)]="phone" placeholder="01XXXXXXXXX" />
          </label>

          <label class="field">
            <span>Reason</span>
            <textarea [(ngModel)]="reason" rows="3" placeholder="Describe your issue..."></textarea>
          </label>

          <button class="primary" (click)="submitRequest()" [disabled]="submitLoading">
            <span *ngIf="!submitLoading">Send Request</span>
            <span *ngIf="submitLoading"><i class="fas fa-spinner fa-spin"></i> Sending...</span>
          </button>

          <div *ngIf="successMessage" class="success banner">
            <i class="fas fa-check-circle"></i>
            <span>{{ successMessage }}</span>
          </div>
          <div *ngIf="errorMessage" class="error banner">
            <i class="fas fa-exclamation-triangle"></i>
            <span>{{ errorMessage }}</span>
          </div>

          <div class="status" *ngIf="getLatestStatus() as latest">
            <div class="status-row">
              <span>Status</span>
              <span
                class="badge"
                [class.pending]="latest.status === 'pending'"
                [class.approved]="latest.status === 'approved'"
                [class.rejected]="latest.status === 'rejected'"
              >
                {{ latest.status | uppercase }}
              </span>
            </div>
            <div class="status-row">
              <span>Phone</span>
              <span>{{ latest.userPhone }}</span>
            </div>
            <div class="status-row">
              <span>Reason</span>
              <span>{{ latest.reason }}</span>
            </div>
            <div class="status-row">
              <span>Submitted</span>
              <span>{{ latest.createdAt | date : 'medium' }}</span>
            </div>
            <div class="status-hint" *ngIf="latest.status === 'approved'">
              Someone will contact you soon.
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
</div>
